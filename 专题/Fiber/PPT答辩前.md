调度简单语言：

- 
  一个调度生命周期分为几个阶段

- - 调度前

  - - 注册任务队列(环状链表，头接尾，尾接头)，按照过期时间从小到大排列，如果当前任务是最饥饿的任务，则排到最前面，并立即开始调度，如果并不是最饥饿的任务，则放到队列中间或者最后面，不做任何操作，等待被调度

  - 调度准备

  - - 通过requestAnimationFrame在下一次屏幕刚开始刷新的帧起点时计算当前帧的截止时间(33毫秒内)
    - 如果不超过当前帧的截止时间且当前任务没有过期，进入任务调度
    - 如果已经超过当前帧的截止时间，但没有过期，进入下一帧，并更新计算帧截止时间，重新判断时间(轮询判断)，直到没有任何过期超时或者超时才进入任务调度
    - 如果已经超过当前帧的截止时间，同时已经过期，进入过期调度

  - 正式调度

  - - 执行调度

    - - 在当前帧的截止时间前批量调用所有任务，不管是否过期

    - 过期调度

    - - 批量调用饥饿任务或超时任务的回调，删除任务节点

  - 调度完成

  - 检查任务队列是否还有任务

  - - 先执行最饥饿的任务
    - 如果存在任务，则进入下一帧，进入下一个调度生命周期

https://zhuanlan.zhihu.com/p/48254036?utm_medium=hao.caibaojian.com&utm_source=hao.caibaojian.com

